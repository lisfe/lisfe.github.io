<!DOCTYPE html>
<html lang="zh-Hant-TW" ng-app="oortiApp">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width initial-scale=1">
    <title>LISFESTUDIO</title>
    <meta name="description" content="LISFESTUDIO有著許多關於前端技術與資料呈現的筆記與分享， 也包含了一些實驗性的新想法
">
    <link rel="stylesheet" href="/css/main.css">
    <!-- add foundation by lisfe-->
    <script src="/js/vendor/modernizr.js"></script>
    <link rel="canonical" href="http://www.lisfestudio.com/oorti_prototype.html">
    <link rel="alternate" type="application/atom+xml" title="LISFESTUDIO" href="http://www.lisfestudio.com /feed.xml " />
    <!-- add angularJS by lisfe>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.js"></script-->
    <script type="text/javascript" src="/js/angular.js"></script>
    <script type="text/javascript" src="/js/d3.min.js"></script>
</head>

<body class="oorti" ng-controller="oortiCtrl">

	<div class="userView" ng-controller="userCtrl" ng-class="{hided: isHided}">
		
		<div class="small-region">
		    <h2 class="region-title">關注</h2>
		    <div class="event-cards-container">
		        <div class="event-card" ng-repeat="newsEvent in focusedEvents">
		            <a href="{[{ newsEvent.link }]}">
		                <div class="news-title">
		                    {[{newsEvent.title}]}
		                </div>
		            </a>
		        </div>
		    </div>
		</div>
		<div class="small-region">
		    <h2 class="region-title">最近</h2>
		    <div class="event-cards-container">
		        <div class="event-card" ng-repeat="newsEvent in focusedEvents">
		            <a href="{[{ newsEvent.link }]}">
		                <div class="news-title">
		                    {[{newsEvent.title}]}
		                </div>
		            </a>
		        </div>
		    </div>
		</div>
		<div class="hideBar" ng-click="changeDisplayMode()"></div>
	</div>


    <div class="row">
        <div class="columns medium-2">

        </div>
        <div class="columns medium-10 today">
            <div class="trend" trend-viewer></div>
            <div class="today-events row">
            	<div class="columns medium-4 events-region">
            		<h2>大事件</h2>
            		<div class="events-container">
            			<div class="event" ng-repeat="newsEvent in newsEvents">
	                        <a href="{[{ newsEvent.link }]}">
	                            <div class="news-title">
	                                {[{newsEvent.title}]}
	                            </div>
	                        </a>
	                    </div>
            		</div>
            	</div>
            	<div class="columns medium-4 events-region">
            		<h2>新事件</h2>
            		<div class="events-container">
            			<div class="event" ng-repeat="newsEvent in newsEvents">
	                        <a href="{[{ newsEvent.link }]}">
	                            <div class="news-title">
	                                {[{newsEvent.title}]}
	                            </div>
	                        </a>
	                    </div>
            		</div>
            	</div>
            	<div class="columns medium-4 events-region">
            		<h2>推薦關注</h2>
            		<div class="events-container">
            			<div class="event" ng-repeat="newsEvent in newsEvents">
	                        <a href="{[{ newsEvent.link }]}">
	                            <div class="news-title">
	                                {[{newsEvent.title}]}
	                            </div>
	                        </a>
	                    </div>
            		</div>
            	</div>
            </div>
            
        </div>
    </div>
    <script type="text/javascript">


    

    var fakeD3Data = [
{
    		name: '柯文哲',
    		values: [
    			{label: new Date(2015,3,0), value: 3},
    			{label: new Date(2015,3,1), value: 3},
    			{label: new Date(2015,3,2), value: 4},
    			{label: new Date(2015,3,3), value: 5},
    			{label: new Date(2015,3,4), value: 2},
    			{label: new Date(2015,3,5), value: 7},
    			{label: new Date(2015,3,6), value: 2},
    			{label: new Date(2015,3,7), value: 2},
    			{label: new Date(2015,3,8), value: 4},
    			{label: new Date(2015,3,9), value: 3},
    			{label: new Date(2015,3,10), value: 2}
    		] 
    	},{
    		name: '高麗菜價格大跌',
    		values: [
		    	{label: new Date(2015,3,0), value: 0},
    			{label: new Date(2015,3,1), value: 0},
    			{label: new Date(2015,3,2), value: 0},
    			{label: new Date(2015,3,3), value: 0},
    			{label: new Date(2015,3,4), value: 0},
    			{label: new Date(2015,3,5), value: 0},
    			{label: new Date(2015,3,6), value: 2},
    			{label: new Date(2015,3,7), value: 7},
    			{label: new Date(2015,3,8), value: 4},
    			{label: new Date(2015,3,9), value: 9},
    			{label: new Date(2015,3,10), value: 2}
    		] 
    	},{
    		name: '亞洲投資銀行',
    		values: [
		    	{label: new Date(2015,3,0), value: 2},
    			{label: new Date(2015,3,1), value: 4},
    			{label: new Date(2015,3,2), value: 6},
    			{label: new Date(2015,3,3), value: 1},
    			{label: new Date(2015,3,4), value: 0},
    			{label: new Date(2015,3,5), value: 0},
    			{label: new Date(2015,3,6), value: 0},
    			{label: new Date(2015,3,7), value: 0},
    			{label: new Date(2015,3,8), value: 0},
    			{label: new Date(2015,3,9), value: 0},
    			{label: new Date(2015,3,10), value: 0}
    		] 
    	},{
    		name: '亞洲投資銀e行',
    		values: [
		    	{label: new Date(2015,3,0), value: 0},
    			{label: new Date(2015,3,1), value: 0},
    			{label: new Date(2015,3,2), value: 0},
    			{label: new Date(2015,3,3), value: 1},
    			{label: new Date(2015,3,4), value: 4},
    			{label: new Date(2015,3,5), value: 3},
    			{label: new Date(2015,3,6), value: 4},
    			{label: new Date(2015,3,7), value: 1},
    			{label: new Date(2015,3,8), value: 0},
    			{label: new Date(2015,3,9), value: 0},
    			{label: new Date(2015,3,10), value: 0}
    		] 
    	}
    ];
    var oortiApp = angular.module('oortiApp', []);
    oortiApp.config(function($interpolateProvider) {
        $interpolateProvider.startSymbol('{[{').endSymbol('}]}');
    });

    oortiApp.directive("userView", function() {
    	return {
    		restrict: "A",

    	}
    });

    oortiApp.directive("trendViewer", function() {
        return {
            restrict: "A",
            link: function(scope, element, attr) {
                console.log(element);

                // width & height
                var margin = {t: 0, b: 40, l: 40, r:40}
                var fullWidth = element[0].offsetWidth;
                var fullHeight = element[0].offsetHeight;
                var width = fullWidth - margin.l - margin.r;
                var height = fullHeight - margin.t - margin.b;

		        // domain : x, y, color
		        var color = d3.scale.ordinal().range(["#222","#555","#999","#EEE"]);
		        var x = d3.time.scale().range([0,width]);
		        var y = d3.scale.linear().range([height, 0]);

		        // Axies 
		        var xAxis = d3.svg.axis().scale(x).orient("bottom");
    			//var	yAxis = d3.svg.axis().scale(y).orient("left");


    			// area
    			var area = d3.svg.area()
		            .interpolate("cardinal")
		            .x(function (d) { return x(d.label); })
		            .y0(function (d) { return y(d.y0 ); })
		            .y1(function (d) { return y(d.y0 + d.y ); });

		        // stack
		        var stack = d3.layout.stack()
		            //.offset("zero")
		            .offset("wiggle")
		            .values(function (d) { return d.values; })
		            .x(function (d) { return d.label; })
		            .y(function (d) { return d.value; });

		        // canvas
                var svg = d3.select(element[0]).append("svg")
                	.attr("width", fullWidth)
                	.attr("height", fullHeight);
                var trend = svg.append("g")
                	.attr("width", width)
                	.attr("height", height)
                	.attr('transform', 'translate(' + margin.l + ', ' + (margin.t - 10) + ')'); // margin 10 between axis


                // domain
                color.domain(fakeD3Data.map(function(d){return d.name;}));
                x.domain([new Date(2015,3,0), new Date(2015,3,10)]);
                y.domain([0,20]);

                // draw stream
                stack(fakeD3Data);
		        var selection = trend.selectAll(".series")
		          .data(fakeD3Data)
		          .enter().append("g")
		          .attr("class", "series")
		          .append("path")
		          .attr("class", "streamPath")
		          .attr("d", function (d) {return area(d.values); })
		          .style("fill", function (d) { return color(d.name); })
		          .style("stroke", "grey");

		        // draw axis
		        svg.append('g')
		        .attr('class', 'x axis')
		        .attr('transform', 'translate(' + margin.l + ', ' + (height+margin.t) + ')')
		        .call(xAxis);

            }
        };
    });

	oortiApp.controller("userCtrl", function($scope) {
		$scope.isHided = false;
		$scope.changeDisplayMode = function(){
			$scope.isHided = !$scope.isHided;
		}
	});
    oortiApp.controller('oortiCtrl', function($scope) {
        $scope.newsEvents = [{
            'title': '高麗菜價格大跌',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [3, 4, 5, 2, 3.4, 7]
        }, {
            'title': '亞洲投資銀行',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 2, 7, 6, 5, 4, 12]
        }, {
            'title': '亞洲銀行',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 2, 7, 6, 5, 4, 12]
        }, {
            'title': '愚人節',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4]
        }, {
            'title': '柯文哲',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 3.3, 1, 3, 5, 5.5, 7, 2.5]
        }];
        $scope.focusedEvents = [{
            'title': '高麗菜價格大跌',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [3, 4, 5, 2, 3.4, 7]
        }, {
            'title': '亞洲投資銀行',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 2, 7, 6, 5, 4, 12]
        }, {
            'title': '亞洲投資銀行',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 2, 7, 6, 5, 4, 12]
        }, {
            'title': '亞洲投資銀行',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 2, 7, 6, 5, 4, 12]
        }, {
            'title': '亞洲投資銀行',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 2, 7, 6, 5, 4, 12]
        }, {
            'title': '亞洲投資銀行',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 2, 7, 6, 5, 4, 12]
        }, {
            'title': '愚人節',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4]
        }, {
            'title': '愚人節',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4]
        }, {
            'title': '愚人節',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4]
        }, {
            'title': '愚人節',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4]
        }, {
            'title': '柯文哲',
            'link': "/oorti_event_prototype.html",
            'viewHeight': [4, 3.3, 1, 3, 5, 5.5, 7, 2.5]
        }];

    });
    </script>
    <script src="/js/vendor/jquery.js"></script> 
<script src="/js/vendor/fastclick.js"></script>
<script src="/js/foundation.min.js"></script> 
<script>$(document).foundation();</script>

</body>

</html>
